ğŸš€ Starting GroundingDINO Detection with Quality Filtering (Module 2)
======================================================================
ğŸ” Quick check: Do we need to do any work?
âš¡ Quick check: Do HQ annotations exist for specific entities?
âš¡ Found 96 images needing work
ğŸ”§ Loading full pipeline components...
ğŸ“± Using device: cuda
ğŸ“Š Loaded metadata: ExperimentMetadata(1 experiments, 96 videos, 96 images)
ğŸ¯ Processing entities: ['20250612_30hpf_ctrl_atf6']
   ğŸ“ Experiment 20250612_30hpf_ctrl_atf6: 96 images
ğŸ“Š Found: 1 experiments, 0 videos, 0 images

============================================================
ğŸ” PHASE 1: GroundingDINO Detection ('individual embryo')
============================================================
ğŸ’¾ Annotations will be saved to: /net/trapnell/vol1/home/mdcolon/proj/morphseq/segmentation_sandbox/data/detections/gdino_detections.json
ğŸ” Checking for missing annotations...
ğŸ“Š Prompt 'individual embryo': 96 missing, 0 annotated
ğŸ“Š Found 96 images needing annotation
ğŸ”„ Loading GroundingDINO model...
final text_encoder_type: bert-base-uncased
GroundedDINO model loaded successfully on cuda.
âœ… Model loaded successfully
ğŸ”„ Processing annotations for prompt: 'individual embryo'
ğŸ”§ Model-specific mode: Only considering annotations from checkpoint_best_regular.pth
ğŸ“Š Prompt 'individual embryo' (for checkpoint_best_regular.pth): 96 missing, 0 annotated
ğŸ“Š Found 96 missing annotations to process

ğŸ”„ Processing 96 images for prompt 'individual embryo'...
ğŸ“ Found paths for 96 images
ğŸš€ Starting inference on 96 images with 1 prompts (96 total operations)
ğŸ”„ [1/96] Processing 20250612_30hpf_ctrl_atf6_F11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [2/96] Processing 20250612_30hpf_ctrl_atf6_A05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [3/96] Processing 20250612_30hpf_ctrl_atf6_F09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [4/96] Processing 20250612_30hpf_ctrl_atf6_G03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [5/96] Processing 20250612_30hpf_ctrl_atf6_D12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [6/96] Processing 20250612_30hpf_ctrl_atf6_G04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [7/96] Processing 20250612_30hpf_ctrl_atf6_H02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [8/96] Processing 20250612_30hpf_ctrl_atf6_G08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [9/96] Processing 20250612_30hpf_ctrl_atf6_H06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [10/96] Processing 20250612_30hpf_ctrl_atf6_F01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [11/96] Processing 20250612_30hpf_ctrl_atf6_G10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [12/96] Processing 20250612_30hpf_ctrl_atf6_G09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [13/96] Processing 20250612_30hpf_ctrl_atf6_E02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [14/96] Processing 20250612_30hpf_ctrl_atf6_C07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C07_ch00_t0000] with prompt 'individual embryo'...
   Found 0 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C07_ch00_t0000: 0 detections (prompt: 'individual embryo')
ğŸ”„ [15/96] Processing 20250612_30hpf_ctrl_atf6_D03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [16/96] Processing 20250612_30hpf_ctrl_atf6_F07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [17/96] Processing 20250612_30hpf_ctrl_atf6_H12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [18/96] Processing 20250612_30hpf_ctrl_atf6_B11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [19/96] Processing 20250612_30hpf_ctrl_atf6_H10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [20/96] Processing 20250612_30hpf_ctrl_atf6_D08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [21/96] Processing 20250612_30hpf_ctrl_atf6_G01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [22/96] Processing 20250612_30hpf_ctrl_atf6_H11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [23/96] Processing 20250612_30hpf_ctrl_atf6_C08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [24/96] Processing 20250612_30hpf_ctrl_atf6_F12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [25/96] Processing 20250612_30hpf_ctrl_atf6_B12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [26/96] Processing 20250612_30hpf_ctrl_atf6_A07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [27/96] Processing 20250612_30hpf_ctrl_atf6_G12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [28/96] Processing 20250612_30hpf_ctrl_atf6_E03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [29/96] Processing 20250612_30hpf_ctrl_atf6_A04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [30/96] Processing 20250612_30hpf_ctrl_atf6_A03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [31/96] Processing 20250612_30hpf_ctrl_atf6_D10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [32/96] Processing 20250612_30hpf_ctrl_atf6_C03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [33/96] Processing 20250612_30hpf_ctrl_atf6_A06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [34/96] Processing 20250612_30hpf_ctrl_atf6_C01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [35/96] Processing 20250612_30hpf_ctrl_atf6_G02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [36/96] Processing 20250612_30hpf_ctrl_atf6_B09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [37/96] Processing 20250612_30hpf_ctrl_atf6_D01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [38/96] Processing 20250612_30hpf_ctrl_atf6_A08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [39/96] Processing 20250612_30hpf_ctrl_atf6_B01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [40/96] Processing 20250612_30hpf_ctrl_atf6_H01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [41/96] Processing 20250612_30hpf_ctrl_atf6_C04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [42/96] Processing 20250612_30hpf_ctrl_atf6_D11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [43/96] Processing 20250612_30hpf_ctrl_atf6_C06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C06_ch00_t0000] with prompt 'individual embryo'...
   Found 0 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C06_ch00_t0000: 0 detections (prompt: 'individual embryo')
ğŸ”„ [44/96] Processing 20250612_30hpf_ctrl_atf6_B05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [45/96] Processing 20250612_30hpf_ctrl_atf6_G06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [46/96] Processing 20250612_30hpf_ctrl_atf6_H03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [47/96] Processing 20250612_30hpf_ctrl_atf6_E12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [48/96] Processing 20250612_30hpf_ctrl_atf6_C02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [49/96] Processing 20250612_30hpf_ctrl_atf6_B08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [50/96] Processing 20250612_30hpf_ctrl_atf6_H08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [51/96] Processing 20250612_30hpf_ctrl_atf6_E05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [52/96] Processing 20250612_30hpf_ctrl_atf6_F02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [53/96] Processing 20250612_30hpf_ctrl_atf6_H05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [54/96] Processing 20250612_30hpf_ctrl_atf6_F06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [55/96] Processing 20250612_30hpf_ctrl_atf6_C12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [56/96] Processing 20250612_30hpf_ctrl_atf6_C10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [57/96] Processing 20250612_30hpf_ctrl_atf6_D02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [58/96] Processing 20250612_30hpf_ctrl_atf6_E07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [59/96] Processing 20250612_30hpf_ctrl_atf6_G05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [60/96] Processing 20250612_30hpf_ctrl_atf6_F08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [61/96] Processing 20250612_30hpf_ctrl_atf6_F10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [62/96] Processing 20250612_30hpf_ctrl_atf6_E11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [63/96] Processing 20250612_30hpf_ctrl_atf6_H09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [64/96] Processing 20250612_30hpf_ctrl_atf6_E06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [65/96] Processing 20250612_30hpf_ctrl_atf6_B10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [66/96] Processing 20250612_30hpf_ctrl_atf6_B06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B06_ch00_t0000] with prompt 'individual embryo'...
   Found 0 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B06_ch00_t0000: 0 detections (prompt: 'individual embryo')
ğŸ”„ [67/96] Processing 20250612_30hpf_ctrl_atf6_H07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [68/96] Processing 20250612_30hpf_ctrl_atf6_D04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [69/96] Processing 20250612_30hpf_ctrl_atf6_E01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [70/96] Processing 20250612_30hpf_ctrl_atf6_E10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [71/96] Processing 20250612_30hpf_ctrl_atf6_E08_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E08_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E08_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [72/96] Processing 20250612_30hpf_ctrl_atf6_E09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [73/96] Processing 20250612_30hpf_ctrl_atf6_A09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [74/96] Processing 20250612_30hpf_ctrl_atf6_A12_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A12_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A12_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [75/96] Processing 20250612_30hpf_ctrl_atf6_D05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [76/96] Processing 20250612_30hpf_ctrl_atf6_F05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [77/96] Processing 20250612_30hpf_ctrl_atf6_D07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [78/96] Processing 20250612_30hpf_ctrl_atf6_F03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [79/96] Processing 20250612_30hpf_ctrl_atf6_C09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [80/96] Processing 20250612_30hpf_ctrl_atf6_D06_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D06_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D06_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [81/96] Processing 20250612_30hpf_ctrl_atf6_D09_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_D09_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_D09_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [82/96] Processing 20250612_30hpf_ctrl_atf6_G11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [83/96] Processing 20250612_30hpf_ctrl_atf6_E04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_E04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_E04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [84/96] Processing 20250612_30hpf_ctrl_atf6_C11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [85/96] Processing 20250612_30hpf_ctrl_atf6_C05_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_C05_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_C05_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [86/96] Processing 20250612_30hpf_ctrl_atf6_B03_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B03_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B03_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [87/96] Processing 20250612_30hpf_ctrl_atf6_A01_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A01_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A01_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [88/96] Processing 20250612_30hpf_ctrl_atf6_B02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [89/96] Processing 20250612_30hpf_ctrl_atf6_G07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_G07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_G07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [90/96] Processing 20250612_30hpf_ctrl_atf6_F04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_F04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_F04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [91/96] Processing 20250612_30hpf_ctrl_atf6_B07_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B07_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B07_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [92/96] Processing 20250612_30hpf_ctrl_atf6_A10_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A10_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A10_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [93/96] Processing 20250612_30hpf_ctrl_atf6_H04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_H04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_H04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [94/96] Processing 20250612_30hpf_ctrl_atf6_B04_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_B04_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_B04_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [95/96] Processing 20250612_30hpf_ctrl_atf6_A11_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A11_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A11_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ”„ [96/96] Processing 20250612_30hpf_ctrl_atf6_A02_ch00_t0000.jpg [image_id: 20250612_30hpf_ctrl_atf6_A02_ch00_t0000] with prompt 'individual embryo'...
   Found 1 detections
â• Added annotation for 20250612_30hpf_ctrl_atf6_A02_ch00_t0000: 1 detections (prompt: 'individual embryo')
ğŸ’¾ Final save after processing 96 images...
âœ… Entity validation passed: 96 images
âœ… Inference complete: processed 96/96 images
âœ… Processed 96 images
âœ… Entity validation passed: 96 images
ğŸ“¦ Created backup: gdino_detections.backup.20250829_072332.json
âœ… Phase 1 complete: Detection finished

============================================================
ğŸ¯ PHASE 2: High-Quality Filtering
============================================================
Found 96 images with 'individual embryo' annotations
ğŸ¯ Generating high-quality annotations...
   Confidence threshold: 0.45
   IoU threshold: 0.5
ğŸ¯ Generating high-quality annotations for 96 images
   Prompt: 'individual embryo', Confidence: 0.45, IoU: 0.5
   Found 93 raw detections
   ğŸ“ˆ Confidence Statistics (before filtering):
      Total detections: 93
      Mean: 0.558
      Median: 0.560
      Min: 0.414
      Max: 0.644
      Q90: 0.602
   After confidence filter: 92 (1 removed)
   After IoU filtering: 92 (0 removed)
   ğŸ“Š Final Statistics:
      Original: 93 detections
      Final: 92 detections (98.9% retained)
      Images: 92
      Experiments: 1
ğŸ“Š Filtering Summary:
   Original detections: 93
   Confidence removed: 1
   IoU removed: 0
   Final detections: 92
   Retention rate: 98.9%
   Final images: 92
   Experiments processed: 1
âœ… Entity validation passed: 96 images
ğŸ“¦ Created backup: gdino_detections.backup.20250829_072332.json
âœ… Phase 2 complete: Quality filtering finished

============================================================
ğŸ“Š FINAL PIPELINE SUMMARY
============================================================

ğŸ“Š ANNOTATION SUMMARY
==============================
ğŸ–¼ï¸  Annotated images: 96
ğŸ“ Total annotations: 96
ğŸ“ Total detections: 93
ğŸ“Š Avg annotations/image: 1.0
ğŸ“Š Avg detections/annotation: 1.0
ğŸ“‚ Metadata images: 96
ğŸ“ˆ Coverage: 100.0%
ğŸ¯ High-quality: 1 experiments, 92 images

ğŸ“ OUTPUT:
   Annotations file: /net/trapnell/vol1/home/mdcolon/proj/morphseq/segmentation_sandbox/data/detections/gdino_detections.json
   Prompt processed: 'individual embryo'
   Quality filtering: Applied
   High-quality results: 1 experiments, 92 images, 92 detections

âœ… ANNOTATION GENERATION COMPLETE!
ğŸ¯ Ready for downstream processing (SAM2, etc.)
